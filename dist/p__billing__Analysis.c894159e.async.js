(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[24],{"4eb9":function(e,t,a){"use strict";var n=a("g09b"),l=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("g9YV");var r=n(a("wCAj"));a("14J3");var u=n(a("BMrR"));a("jCWc");var d=n(a("kPKH"));a("iQDF");var i=n(a("+eQT"));a("T2oS");var o=n(a("W9HT"));a("Pwec");var f=n(a("CtXQ")),s=n(a("2Taf")),c=n(a("vZ4D")),p=n(a("l4Ni")),h=n(a("ujKo")),m=n(a("rlhR")),v=n(a("MhPg")),g=n(a("p0pE")),y=n(a("gWZ8"));a("Znn+");var b=n(a("ZTPi"));a("OaEy");var S,E,M=n(a("2fM7")),Y=l(a("q1tI")),k=n(a("+JSP")),w=a("MuoO"),D=a("fVDY"),T=n(a("PHSE")),x=n(a("wd/R")),A=M.default.Option,_=b.default.TabPane,C=[{title:"Service",dataIndex:"res_type",key:"res_type",width:150},{title:"Month",dataIndex:"month",key:"month",width:150},{title:"Amount Due(SAR)",dataIndex:"rate",key:"rate",width:150}];function F(e){if(!e.length)return[];var t=e.reduce(function(e,t,a,n){var l=t.summary;if(0==l.length){var r=n.length,u=(0,x.default)().subtract(r-1-a,"months").format("MMMM YYYY");return[].concat((0,y.default)(e),[{month:u,rate:"0 SAR",res_type:"instance"},{month:u,rate:"0 SAR",res_type:"volume.size"},{month:u,rate:"0 SAR",res_type:"ip.floating"}])}return[].concat((0,y.default)(e),(0,y.default)(l.map(function(e){return{month:(0,x.default)(e.begin).format("MMMM YYYY"),rate:e.rate,res_type:e.res_type}})))},[]);return t}var L=(S=(0,w.connect)(function(e){var t=e.global,a=e.loading;return{isLoadingData:a.effects["global/fetchSpendByServiceFromTo"]||a.effects["global/fetchSpends"],global:(0,g.default)({},t)}}),S(E=function(e){function t(e){var a;return(0,s.default)(this,t),a=(0,p.default)(this,(0,h.default)(t).call(this,e)),a.state={date:null,summary:[],spendByService:[],tableData:[]},a.onChange=a.onChange.bind((0,m.default)(a)),a.handleServiceFilter=a.handleServiceFilter.bind((0,m.default)(a)),a}return(0,v.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"global/fetchSpends",payload:{num_months:6,groupby:"res_type"}}),e({type:"global/fetchSpendByServiceFromTo",payload:{begin:(0,x.default)().startOf("month").unix(),end:(0,x.default)().endOf("month").unix()}})}},{key:"transformToTabular",value:function(e){var t=e.map(function(e,t,a){var n=e.summary;if(0==n.length){var l=a.length,r=(0,x.default)().subtract(l-1-t,"months").format("MMMM YYYY");return{month:r,rate:0}}var u=n.reduce(function(e,t){return e+Number(t.rate)},0);return{month:(0,x.default)(n[0].begin).format("MMMM YYYY"),rate:u}});return t}},{key:"onChange",value:function(e,t){var a=this.props.dispatch;a({type:"global/fetchSpendByServiceFromTo",payload:{begin:e[0].unix(),end:e[1].unix()}})}},{key:"componentDidUpdate",value:function(e){if(this.props.global.spends.length&&0==this.state.tableData.length){var t=F(this.props.global.spends);this.setState({tableData:t})}}},{key:"handleServiceFilter",value:function(e){if("ALL"===e){var t=F(this.props.global.spends);this.setState({tableData:t})}else{var a=F(this.props.global.spends),n=a.filter(function(t){return t.res_type===e});this.setState({tableData:n})}}},{key:"render",value:function(){if(this.props.isLoadingData)return Y.default.createElement("div",{style:{textAlign:"center",marginTop:"150px"}},Y.default.createElement(o.default,{indicator:Y.default.createElement(f.default,{type:"loading",style:{fontSize:34},spin:!0})}));var e=i.default.RangePicker,t=(0,D.transform)(this.props.global.spends),a=this.props.global.spendByService;return Y.default.createElement(Y.default.Fragment,null,Y.default.createElement("div",{style:{padding:"35px"}},Y.default.createElement(u.default,null,Y.default.createElement(d.default,{lg:12},"Time \xa0",Y.default.createElement(e,{showTime:!0,onChange:this.onChange,defaultValue:[(0,x.default)().startOf("month"),(0,x.default)().endOf("month")]})),Y.default.createElement(d.default,{lg:12},"Filter by \xa0",Y.default.createElement(M.default,{defaultValue:"ALL",style:{width:120},onChange:this.handleServiceFilter},Y.default.createElement(A,{value:"ALL"},"ALL Products"),Y.default.createElement(A,{value:"instance"},"Elastic Cloud Server"),Y.default.createElement(A,{value:"ip.floating"},"Network"),Y.default.createElement(A,{value:"volume.size"},"Elastic Volume Service")))),Y.default.createElement("span",{style:{display:"block",height:"20px"}}),Y.default.createElement(b.default,{type:"card"},Y.default.createElement(_,{tab:"Expense by date",key:"1"},Y.default.createElement(k.default,{dataSource:t})),Y.default.createElement(_,{tab:"Expense by service",key:"2"},Y.default.createElement(T.default,{data:null===a||void 0===a?void 0:a.summary}))),Y.default.createElement(r.default,{dataSource:this.state.tableData,columns:C})))}}]),t}(Y.default.Component))||E);t.default=L}}]);