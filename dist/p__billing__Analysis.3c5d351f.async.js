(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[24],{"4eb9":function(e,t,a){"use strict";var n=a("g09b"),l=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("g9YV");var r=n(a("wCAj"));a("14J3");var u=n(a("BMrR"));a("jCWc");var d=n(a("kPKH"));a("iQDF");var i=n(a("+eQT"));a("T2oS");var o=n(a("W9HT")),f=n(a("2Taf")),s=n(a("vZ4D")),c=n(a("l4Ni")),p=n(a("ujKo")),h=n(a("rlhR")),m=n(a("MhPg")),v=n(a("p0pE")),g=n(a("gWZ8"));a("Znn+");var y=n(a("ZTPi"));a("OaEy");var b,S,E=n(a("2fM7")),M=l(a("q1tI")),Y=n(a("+JSP")),k=a("MuoO"),w=a("fVDY"),D=a("RBnf"),T=n(a("PHSE")),x=n(a("wd/R")),A=E.default.Option,_=y.default.TabPane,L=[{title:"Service",dataIndex:"res_type",key:"res_type",width:150},{title:"Month",dataIndex:"month",key:"month",width:150},{title:"Amount Due(SAR)",dataIndex:"rate",key:"rate",width:150}];function C(e){if(!e.length)return[];var t=e.reduce(function(e,t,a,n){var l=t.summary;if(0==l.length){var r=n.length,u=(0,x.default)().subtract(r-1-a,"months").format("MMMM YYYY");return[].concat((0,g.default)(e),[{month:u,rate:"0 SAR",res_type:"instance"},{month:u,rate:"0 SAR",res_type:"volume.size"},{month:u,rate:"0 SAR",res_type:"ip.floating"}])}return[].concat((0,g.default)(e),(0,g.default)(l.map(function(e){return{month:(0,x.default)(e.begin).format("MMMM YYYY"),rate:e.rate,res_type:e.res_type}})))},[]);return t}var F=(b=(0,k.connect)(function(e){var t=e.global,a=e.loading;return{isLoadingData:a.effects["global/fetchSpendByServiceFromTo"]||a.effects["global/fetchSpends"],global:(0,v.default)({},t)}}),b(S=function(e){function t(e){var a;return(0,f.default)(this,t),a=(0,c.default)(this,(0,p.default)(t).call(this,e)),a.state={date:null,summary:[],spendByService:[],tableData:[]},a.onChange=a.onChange.bind((0,h.default)(a)),a.handleServiceFilter=a.handleServiceFilter.bind((0,h.default)(a)),a}return(0,m.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"global/fetchSpends",payload:{num_months:6,groupby:"res_type"}}),e({type:"global/fetchSpendByServiceFromTo",payload:{begin:(0,x.default)().startOf("month").unix(),end:(0,x.default)().endOf("month").unix()}})}},{key:"transformToTabular",value:function(e){var t=e.map(function(e,t,a){var n=e.summary;if(0==n.length){var l=a.length,r=(0,x.default)().subtract(l-1-t,"months").format("MMMM YYYY");return{month:r,rate:0}}var u=n.reduce(function(e,t){return e+Number(t.rate)},0);return{month:(0,x.default)(n[0].begin).format("MMMM YYYY"),rate:u}});return t}},{key:"onChange",value:function(e,t){var a=this.props.dispatch;a({type:"global/fetchSpendByServiceFromTo",payload:{begin:e[0].unix(),end:e[1].unix()}})}},{key:"componentDidUpdate",value:function(e){if(this.props.global.spends.length&&0==this.state.tableData.length){var t=C(this.props.global.spends);this.setState({tableData:t})}}},{key:"handleServiceFilter",value:function(e){if("ALL"===e){var t=C(this.props.global.spends);this.setState({tableData:t})}else{var a=C(this.props.global.spends),n=a.filter(function(t){return t.res_type===e});this.setState({tableData:n})}}},{key:"render",value:function(){if(this.props.isLoadingData)return M.default.createElement("div",{style:{textAlign:"center",marginTop:"150px"}},M.default.createElement(o.default,{indicator:M.default.createElement(D.LoadingOutlined,{style:{fontSize:34},spin:!0})}));var e=i.default.RangePicker,t=(0,w.transform)(this.props.global.spends),a=this.props.global.spendByService;return M.default.createElement(M.default.Fragment,null,M.default.createElement("div",{style:{padding:"35px"}},M.default.createElement(u.default,null,M.default.createElement(d.default,{lg:12},"Time \xa0",M.default.createElement(e,{showTime:!0,onChange:this.onChange,defaultValue:[(0,x.default)().startOf("month"),(0,x.default)().endOf("month")]})),M.default.createElement(d.default,{lg:12},"Filter by \xa0",M.default.createElement(E.default,{defaultValue:"ALL",style:{width:120},onChange:this.handleServiceFilter},M.default.createElement(A,{value:"ALL"},"ALL Products"),M.default.createElement(A,{value:"instance"},"Elastic Cloud Server"),M.default.createElement(A,{value:"ip.floating"},"Network"),M.default.createElement(A,{value:"volume.size"},"Elastic Volume Service")))),M.default.createElement("span",{style:{display:"block",height:"20px"}}),M.default.createElement(y.default,{type:"card"},M.default.createElement(_,{tab:"Expense by date",key:"1"},M.default.createElement(Y.default,{dataSource:t})),M.default.createElement(_,{tab:"Expense by service",key:"2"},M.default.createElement(T.default,{data:null===a||void 0===a?void 0:a.summary}))),M.default.createElement(r.default,{dataSource:this.state.tableData,columns:L})))}}]),t}(M.default.Component))||S);t.default=F}}]);